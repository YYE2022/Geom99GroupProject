<!DOCTYPE html>
<html lang="en">
<head>
<!--Template from w3school: https://www.w3schools.com/howto/howto_make_a_website.asp*/-->
<title>Methodology</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="header">
  <h1>Methods in Implementing the Web GIS Solution</h1>
  <p>Web 6</p>
</div>

<div class="navbar">
  <a href="index.html">About</a>
  <a href="method.html">Methodology</a>
  <a href="solution.html">Solution</a>
  <a href="team.html" class="right">Team</a>
</div>

<div class="main">
  <h2>Our Methods of Providing a Better Web Map</h2>
  <p>The following methods demonstrated on this page will show our processes and the approaches we took, along with any failings or successes we had towards our solution</p>
  <hr></hr>
  <h2>Acquiring the Data</h2>
  <p>The data was obtained from the ArcGIS REST Endpoint from the Ministry of Environment. This is based off of Land Information Ontario (LIO) where the data containing the water quality, as well as the watercourse and waterstation
    feature classes, are located. This was the primary dataset we used in conjunction with technologies we constructed to provide a solution</p> 
  <p>The map server containing the data can be found by the link <a href="https://ws.lioservices.lrc.gov.on.ca/arcgis2/rest/services/MOE/PWQMN/MapServer">here</a>. It contains three layers and is shown in the image below. The items from these layers 
  were then incorporated into our ArcGIS Online accounts, and more specifically as items within our groups (Web 6) content.</p>
</div>

<img src=ArcGISServer.jpg alt="Server" class="center">

<div class="main">
  <p>The two layers primarily used were the <a href="https://ws.lioservices.lrc.gov.on.ca/arcgis2/rest/services/MOE/PWQMN/MapServer/0">PWQMN Stations - Small</a> layer and the <a href="https://ws.lioservices.lrc.gov.on.ca/arcgis2/rest/services/MOE/PWQMN/MapServer/2">OHN Watercourse</a>
    layer. They were brought over into the ArcGIS Online group content for Web 6 as items to be used in coding web applications using the Javascript API and Esri Leaflet from ArcGIS Developers. Below are snapshots of those feature layers:
</div>

<h3 class="main">This is the watercourse feature layer that is an item in our ArcGIS Online group content.</h3>
<img src=Watercourses.jpg alt="Watercourse" class="center">

<h3 class="main">This is the station feature layer being the second item used from our AGOL account.</h3>
<img src=StationLocations.jpg alt="Stations" class="center">

<div class="main">
  <h2>Constructing a Solution through Esri Leaflet and ArcGIS Developer</h2>
  <p>Using the Javascript API key from an ArcGIS Developers account, A solution was contructed that zoomed in on the watercourses location. Javscript was coded to enable popups on stations that contained
    water quality data on Chlorides, Nitrates and Phosphates, and have these stations point at the rivers in the watercourse where the reading was taken. 
    Through research, the threshold of dangerous levels of these macronutrients was determined, levels which would contribute to algae blooms and unhealthy water quality. The Javascript that was coded also enabled
    queries on the web app, which would allow the user to click on the stations that contained dangerous readings of these macronutrients after choosing through a drop down menu. This code was enabled by the Esri Leaflet plugin.
  </p>
</div>

<h3 class="main">Below shows the API Key generated in ArcGIS Developers along with the HTML, CSS and Javascript code using the Esri Leaflet Plugin for the web solution:</h3>
<img src=APIKey.jpg alt="Key" class="center">
<img src=LeafletScript.jpg alt="Script" class="center">

<br>

<div class="main">
  <h2>Issues with the Solution</h2>
  <p>There were some attempts to improve the solution, primarily to highlight the watercourses themselves and have them be color coded based on the information from the water stations. However, there weren't enough attributes between water stations in enough locations (tied to the watercourse)
    that can enable a consistent symbology within the watercourse. More improvements can be made upon this solution such as imrpoving the topological rules of the watercourse feature layer, and have the popups from the stations contain more information for specific use cases (rather then just
    for algae bloom monitoring).
  </p>
</div>

<hr>

<div class="main">
  <h2>OpenLayers: Similar Approach as Esri Leaflet</h2>
    <p>OpenLayers is an open source JavaScript library and it makes it esy to put a dynamic map in web page. It can display tiles, vector data loaded from any source. </p>
  <img src=yye_ol.jpg alt="openlayer" class="center1" >

  <h3>Process</h3>
  <ul>
  <li>1. Copy the code from <a href="https://developers.arcgis.com/openlayers/layers/add-a-feature-layer-as-geojson/">ArcGIS Developers OpenLayers</a> to github.</li>
  <li>2. replace the API key, basemap, center latitude and longitude, zoom level.</li>
  <li>2. Have the ArcGIS Rest Service layer from HTML to Geojson format. </li>
  <img src=geojson.jpg alt="geojsonformat" class="center1" >
  <li>3. Edit the pop-up window information to display the water quality data regarding the Chlorides, Nitrates and Phosphates level.</li>
  <li>The result can be found <a href="https://yye2022.github.io/geom99lab4/openlayerdemo.html">here</a> on github. </li>
  </ul>
  <h3>Issues with the Solution</h3>
  <p>While attempting to add watercourse features to the map, there was an issue with the watercourse not appearing correctly. The map did not display any watercourse features until a query was performed. Several solutions were tried before the watercourses finally appeared when the query "WHERE Shape_Length > 4000" was used. However, it was observed that the watercourse features that appeared with "Shape_Length > 4000" were different from those with "Shape_Length > 10000". Although the "Shape_Length > 4000" query displayed more watercourses than the "Shape_Length > 10000" query, some watercourses that appeared with "Shape_Length > 10000" were not displayed with "Shape_Length > 4000".</p>
  <img src=query.jpg alt="query" class="center1" >
  

 </div> 
<hr>

<div class="main">
  <h2>ArcGIS Experience Builder</h2>
  <p>Esri’s ArcGIS Experience Builder is a configurable solution that gives an organization the ability to build a web app without writing code. There are several templates available, 
    each with their own unique use cases. For this project, the team used the Chart Viewer template to better visualize the water quality monitoring data. This solution requires
     no coding experience, and is suitable for an organization that has access to ArcGIS Online and its technologies.
  </p>
  <h3>Process</h3>
  <p>To make use of the Chart Viewer template, a web map that contains charts must first be created. This can be done by entering the Content view in ArcGIS online, and creating a new map. On the right-hand tool bar, select “Configure charts” and go to “+ Add chart” > Histogram. 
    Under “Number”, select a variable (ie. Chloride). Repeat this process for the remaining variables.</p>
  <p>The web map can now be configured. In ArcGIS Online, go to Content > Create app > Configurable Apps and select the Chart Viewer template. The following workflow should then be employed:</p>
  <ul>
  <li>1.	Select a map.</li>
  <li>2.	Select the “Stack” layout with a medium panel size.</li>
  <li>3.	Add a cover page and header.</li>
  <li>4.	Select the interactivity options of interest.</li>
  <li>5.	Adjust the theme and layout.</li>
  <li>6.	Publish the web app and share it with your organization and/or group.</li>
  </ul>
  
  <img src=experience-builder-steps.jpg alt="Experience Builder steps" class="large-img" width="800px">

  <p>The results:</p>

  <img src=experience-builder.jpg alt="Experience Builder results" class="large-img" width="800px">

  <h3>The Pros</h3>
  <p>Experience Builder is a great tool that can be used to visualize several statistics at once. The user can get a quick sense of the quantities of chemicals across the area. </p>
  <h3>The Cons</h3>
  <p>The app does not give the viewer any information regarding the safety of the water. A dropdown menu or a Dashboards indicator displaying low, medium, and high chemical concentrations may give the viewer a better understanding of the safety of the water. It also does not give the user the ability 
    to customize the map elements with Arcade.</p>
  <h3>Conclusion</h3>
  <p>Since the solution does not have a drop-down menu, indicators, or the ability to customize the map elements using Arcade, it did not meet the needs of the project.</p>
</div>

<hr>

<div class="main">
  <h2>ArcGIS Dashboards</h2>
  <p>
    Esri’s ArcGIS Dashboards is another configurable solution that can be used to build web apps without writing code, and they are able to display multiple datasets and statistics at once using an interactive interface and custom visualizations. 
    Dashboards can help organizations make decisions or inform the public by showing trends in data, or monitoring the status of a particular attribute in real time. Some of their key features include indicators, graphs, and charts, all of which can be customized using Arcade.
  </p>
  <h3>Process</h3>
  <h4>Charts</h4>
  <p>
    To create an interactive chart, go to Layout > Add element > Serial chart and under “Categories from”, select “Add field” to add all of the desired variables. Under “Statistic”, select “Average”. To make the graph responsive to changes to the map extent, 
    hover over the map and go into the settings. Under “Map actions”, go to “Filter” and select the chart of interest.
  </p>
  <p>Results:</p>
  <img src=dashboard-method-1.jpg alt="Dashboard charts" class="large-img" width="800px">

  <h4>Indicators</h4>
  <p>
    To customize an indicator, go into the settings, and under Data > Statistic, select the statistic of interest. For this example, the average concentration of chloride was used. Enter the following code:
  </p>
  <pre>
    <code>
    var color = '';

    if($datapoint['avg_CHLORIDE'] >= 250){
      text = 'High';
      color = 'red';
    }

    if($datapoint['avg_CHLORIDE'] >= 50){
      text = 'Medium';
      color = 'orange';
      }

    else{
      text = 'Low';
      color = 'green';
    }

    return {
      textColor: color,
      middleText: text,
      middleTextColor: '',
      middleTextOutlineColor: '',
      middleTextMaxSize: 'large',
    }
    </code>
  </pre>

  <p>
    The indicator should now turn red when the data points have an average of >=250 mg/L, orange at >= 50mg/L, and green at >= 0 mg/L. The text will also change to High, Medium, and Low, respectively. 
    Ensure that the indicators change depending on the map extent by going into the map’s settings, selecting “Map actions” > “Filter”, and selecting the indicator. 
  </p>

  <img src=dashboard-method-2.jpg alt="Dashboard indicators" class="large-img" width="800px">

  <h3>Conclusion</h3>
  <p>
    Overall, Esri’s ArcGIS Online Dashboards is a more suitable Esri solution due to its ability to include drop-down menus, indicators, and the ability to customize the map elements using Arcade.
  </p>
</div>


<div class="footer">
  <p>© Web 6 Group Project 2023 | Fleming College </p> 
</div>

</body>
</html>

